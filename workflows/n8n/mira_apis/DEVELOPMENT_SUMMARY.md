# Mira APIs n8n èŠ‚ç‚¹åŒ…å¼€å‘æ€»ç»“

## é¡¹ç›®æ¦‚å†µ

åŸºäº Mira App Server API æ–‡æ¡£ï¼Œæˆ‘ä»¬æˆåŠŸåˆ›å»ºäº†ä¸€ä¸ªå®Œæ•´çš„ n8n ç¤¾åŒºèŠ‚ç‚¹åŒ…ï¼ŒåŒ…å«ä»¥ä¸‹ç»„ä»¶ï¼š

### ğŸ“ é¡¹ç›®ç»“æ„
```
workflows/n8n/mira_apis/
â”œâ”€â”€ package.json                    # npm åŒ…é…ç½®
â”œâ”€â”€ tsconfig.json                   # TypeScript é…ç½®
â”œâ”€â”€ index.ts                        # å…¥å£æ–‡ä»¶
â”œâ”€â”€ README.md                       # é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ credentials/
â”‚   â””â”€â”€ MiraApi.credentials.ts      # Mira API è®¤è¯å‡­æ®
â””â”€â”€ nodes/
    â”œâ”€â”€ MiraAuth/
    â”‚   â”œâ”€â”€ MiraAuth.node.ts        # è®¤è¯ç®¡ç†èŠ‚ç‚¹
    â”‚   â””â”€â”€ mira.svg                # èŠ‚ç‚¹å›¾æ ‡
    â”œâ”€â”€ MiraUser/
    â”‚   â”œâ”€â”€ MiraUser.node.ts        # ç”¨æˆ·ç®¡ç†èŠ‚ç‚¹
    â”‚   â””â”€â”€ mira.svg                # èŠ‚ç‚¹å›¾æ ‡
    â”œâ”€â”€ MiraAdmin/
    â”‚   â”œâ”€â”€ MiraAdmin.node.ts       # ç®¡ç†å‘˜ç®¡ç†èŠ‚ç‚¹
    â”‚   â””â”€â”€ mira.svg                # èŠ‚ç‚¹å›¾æ ‡
    â”œâ”€â”€ MiraLibrary/
    â”‚   â”œâ”€â”€ MiraLibrary.node.ts     # ç´ æåº“ç®¡ç†èŠ‚ç‚¹
    â”‚   â””â”€â”€ mira.svg                # èŠ‚ç‚¹å›¾æ ‡
    â”œâ”€â”€ MiraPlugin/
    â”‚   â”œâ”€â”€ MiraPlugin.node.ts      # æ’ä»¶ç®¡ç†èŠ‚ç‚¹
    â”‚   â””â”€â”€ mira.svg                # èŠ‚ç‚¹å›¾æ ‡
    â”œâ”€â”€ MiraFile/
    â”‚   â”œâ”€â”€ MiraFile.node.ts        # æ–‡ä»¶ç®¡ç†èŠ‚ç‚¹
    â”‚   â””â”€â”€ mira.svg                # èŠ‚ç‚¹å›¾æ ‡
    â”œâ”€â”€ MiraDatabase/
    â”‚   â”œâ”€â”€ MiraDatabase.node.ts    # æ•°æ®åº“ç®¡ç†èŠ‚ç‚¹
    â”‚   â””â”€â”€ mira.svg                # èŠ‚ç‚¹å›¾æ ‡
    â”œâ”€â”€ MiraDevice/
    â”‚   â”œâ”€â”€ MiraDevice.node.ts      # è®¾å¤‡ç®¡ç†èŠ‚ç‚¹
    â”‚   â””â”€â”€ mira.svg                # èŠ‚ç‚¹å›¾æ ‡
    â””â”€â”€ MiraSystem/
        â”œâ”€â”€ MiraSystem.node.ts      # ç³»ç»ŸçŠ¶æ€èŠ‚ç‚¹
        â””â”€â”€ mira.svg                # èŠ‚ç‚¹å›¾æ ‡
```

## ğŸ”§ å·²å®ç°çš„èŠ‚ç‚¹

### 1. Mira Auth èŠ‚ç‚¹ (MiraAuth)
**åŠŸèƒ½**ï¼šå¤„ç† Mira App Server çš„è®¤è¯æ“ä½œ
- âœ… ç™»å½• (Login)
- âœ… ç™»å‡º (Logout)  
- âœ… éªŒè¯ä»¤ç‰Œ (Verify Token)
- âœ… è·å–æƒé™ç  (Get Permission Codes)

### 2. Mira User èŠ‚ç‚¹ (MiraUser)
**åŠŸèƒ½**ï¼šç®¡ç†ç”¨æˆ·ç›¸å…³æ“ä½œ
- âœ… è·å–ç”¨æˆ·ä¿¡æ¯ (Get Info)
- âœ… æ›´æ–°ç”¨æˆ·ä¿¡æ¯ (Update Info)

### 3. Mira Library èŠ‚ç‚¹ (MiraLibrary)
**åŠŸèƒ½**ï¼šç®¡ç†ç´ æåº“æ“ä½œ
- âœ… è·å–ç´ æåº“åˆ—è¡¨ (List)
- âœ… åˆ›å»ºç´ æåº“ (Create)
- âœ… æ›´æ–°ç´ æåº“ (Update)
- âœ… åˆ é™¤ç´ æåº“ (Delete)
- âœ… å¯åŠ¨ç´ æåº“æœåŠ¡ (Start)
- âœ… åœæ­¢ç´ æåº“æœåŠ¡ (Stop)

### 4. Mira Plugin èŠ‚ç‚¹ (MiraPlugin)
**åŠŸèƒ½**ï¼šç®¡ç†æ’ä»¶æ“ä½œ
- âœ… è·å–æ’ä»¶åˆ—è¡¨ (List)
- âœ… è·å–æ’ä»¶ä¿¡æ¯ (Get Info)
- âœ… å¯åŠ¨æ’ä»¶ (Start)
- âœ… åœæ­¢æ’ä»¶ (Stop)
- âœ… å®‰è£…æ’ä»¶ (Install)
- âœ… å¸è½½æ’ä»¶ (Uninstall)

### 5. Mira Admin èŠ‚ç‚¹ (MiraAdmin)
**åŠŸèƒ½**ï¼šç®¡ç†ç®¡ç†å‘˜æ“ä½œ
- âœ… è·å–ç®¡ç†å‘˜åˆ—è¡¨ (List)
- âœ… åˆ›å»ºç®¡ç†å‘˜ (Create)

### 6. Mira File èŠ‚ç‚¹ (MiraFile)
**åŠŸèƒ½**ï¼šç®¡ç†æ–‡ä»¶æ“ä½œ
- âœ… ä¸Šä¼ æ–‡ä»¶ (Upload)
- âœ… ä¸‹è½½æ–‡ä»¶ (Download)
- âœ… åˆ é™¤æ–‡ä»¶ (Delete)

### 7. Mira Database èŠ‚ç‚¹ (MiraDatabase)
**åŠŸèƒ½**ï¼šç®¡ç†æ•°æ®åº“æ“ä½œ
- âœ… è·å–è¡¨åˆ—è¡¨ (List Tables)
- âœ… è·å–è¡¨æ•°æ® (Get Table Data)
- âœ… è·å–è¡¨ç»“æ„ (Get Table Schema)

### 8. Mira Device èŠ‚ç‚¹ (MiraDevice)
**åŠŸèƒ½**ï¼šç®¡ç†è®¾å¤‡æ“ä½œ
- âœ… è·å–æ‰€æœ‰è®¾å¤‡ (List All)
- âœ… è·å–ç‰¹å®šåº“è®¾å¤‡ (Get By Library)
- âœ… æ–­å¼€è®¾å¤‡è¿æ¥ (Disconnect)
- âœ… å‘é€æ¶ˆæ¯åˆ°è®¾å¤‡ (Send Message)
- âœ… è·å–è®¾å¤‡ç»Ÿè®¡ (Get Stats)

### 9. Mira System èŠ‚ç‚¹ (MiraSystem)
**åŠŸèƒ½**ï¼šè·å–ç³»ç»ŸçŠ¶æ€
- âœ… è¯¦ç»†å¥åº·æ£€æŸ¥ (Health Check)
- âœ… ç®€å•å¥åº·æ£€æŸ¥ (Simple Health Check)

## ğŸ” è®¤è¯é…ç½®

**MiraApi å‡­æ®ç±»å‹**ï¼š
- Server URL (é»˜è®¤: http://localhost:8081)
- Username 
- Password

## ğŸ§ª æµ‹è¯•å·¥ä½œæµ

âœ… **å·²åˆ›å»ºåŸºç¡€æµ‹è¯•å·¥ä½œæµ** "Mira APIs Test Workflow" (ID: IucoEKqgkV8Ogp1a)

**å·¥ä½œæµç¨‹**ï¼š
1. Start â†’ Mira Login (ç™»å½•è·å– token)
2. Mira Login â†’ Extract Token (æå–è®¿é—®ä»¤ç‰Œ)
3. Extract Token â†’ Get User Info (è·å–ç”¨æˆ·ä¿¡æ¯)
4. Get User Info â†’ Get Libraries (è·å–ç´ æåº“åˆ—è¡¨)

âœ… **å·²åˆ›å»ºå®Œæ•´æµ‹è¯•å·¥ä½œæµ** "Mira APIs Complete Test Workflow" (ID: TakZgWRDa3rSi2aU)

**å·¥ä½œæµç¨‹**ï¼š
1. Start â†’ Mira Login (ç™»å½•è·å– token)
2. Mira Login â†’ Get System Health (ç³»ç»Ÿå¥åº·æ£€æŸ¥)
3. Get System Health â†’ Get Device Stats (è®¾å¤‡ç»Ÿè®¡)
4. Get Device Stats â†’ List Database Tables (æ•°æ®åº“è¡¨åˆ—è¡¨)
5. List Database Tables â†’ List Admin Users (ç®¡ç†å‘˜åˆ—è¡¨)

**éªŒè¯çŠ¶æ€**ï¼š
- âœ… åŸºç¡€å·¥ä½œæµéªŒè¯é€šè¿‡ (5ä¸ªèŠ‚ç‚¹ï¼Œ4ä¸ªè¿æ¥)
- âœ… å®Œæ•´å·¥ä½œæµéªŒè¯é€šè¿‡ (6ä¸ªèŠ‚ç‚¹ï¼Œ5ä¸ªè¿æ¥)
- âœ… Mira App Server è¿è¡Œæ­£å¸¸ (ç«¯å£ 8081)
- âœ… API ç«¯ç‚¹æµ‹è¯•é€šè¿‡ï¼š
  - Health: `GET /health` â†’ çŠ¶æ€: ok
  - Login: `POST /api/auth/login` â†’ è¿”å› access token

## ğŸ“‹ API è¦†ç›–ç‡

åŸºäº `packages/mira-app-server/API_REFERENCE.md` çš„ 9 ä¸ªä¸»è¦ API åˆ†ç»„ï¼š

- âœ… **è®¤è¯ç›¸å…³ API** (å®Œæ•´å®ç°)
- âœ… **ç”¨æˆ·ç®¡ç† API** (å®Œæ•´å®ç°)
- âœ… **ç®¡ç†å‘˜ç®¡ç† API** (å®Œæ•´å®ç°)
- âœ… **ç´ æåº“ç®¡ç† API** (å®Œæ•´å®ç°)
- âœ… **æ’ä»¶ç®¡ç† API** (å®Œæ•´å®ç°)
- âœ… **æ–‡ä»¶ç®¡ç† API** (å®Œæ•´å®ç°)
- âœ… **æ•°æ®åº“ç®¡ç† API** (å®Œæ•´å®ç°)
- âœ… **è®¾å¤‡ç®¡ç† API** (å®Œæ•´å®ç°)
- âœ… **ç³»ç»ŸçŠ¶æ€ API** (å®Œæ•´å®ç°)

**å½“å‰è¦†ç›–ç‡**: 9/9 (100%) ğŸ‰

## ğŸš€ éƒ¨ç½²å°±ç»ª

èŠ‚ç‚¹åŒ…å·²å‡†å¤‡å¥½è¿›è¡Œï¼š
- âœ… TypeScript ç¼–è¯‘
- âœ… npm åŒ…å‘å¸ƒ
- âœ… n8n ç¤¾åŒºèŠ‚ç‚¹å®‰è£…

## ğŸ” éªŒè¯ç»“æœ

**å·¥ä½œæµéªŒè¯é€šè¿‡** âœ…
- åŸºç¡€æµ‹è¯•å·¥ä½œæµ: 5 ä¸ªèŠ‚ç‚¹ï¼Œ4 ä¸ªè¿æ¥ï¼Œ0 ä¸ªé”™è¯¯
- å®Œæ•´æµ‹è¯•å·¥ä½œæµ: 6 ä¸ªèŠ‚ç‚¹ï¼Œ5 ä¸ªè¿æ¥ï¼Œ0 ä¸ªé”™è¯¯
- è¡¨è¾¾å¼éªŒè¯é€šè¿‡
- è­¦å‘Šä¸»è¦ä¸ºé”™è¯¯å¤„ç†å»ºè®®

**API è¿é€šæ€§æµ‹è¯•** âœ…
- Mira Server è¿è¡ŒçŠ¶æ€: æ­£å¸¸
- åŸºç¡€ API è°ƒç”¨: æˆåŠŸ
- è®¤è¯æµç¨‹: å·¥ä½œæ­£å¸¸

## ğŸ“ åç»­æ”¹è¿›å»ºè®®

1. **é”™è¯¯å¤„ç†ä¼˜åŒ–**ï¼šæ·»åŠ æ›´å®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶å’Œé‡è¯•é€»è¾‘
2. **æ–‡æ¡£å®Œå–„**ï¼šä¸ºæ¯ä¸ªèŠ‚ç‚¹æ·»åŠ è¯¦ç»†çš„ä½¿ç”¨ç¤ºä¾‹å’Œæœ€ä½³å®è·µ
3. **å•å…ƒæµ‹è¯•**ï¼šåˆ›å»ºè‡ªåŠ¨åŒ–æµ‹è¯•å¥—ä»¶éªŒè¯æ‰€æœ‰èŠ‚ç‚¹åŠŸèƒ½
4. **å›¾æ ‡ä¼˜åŒ–**ï¼šä¸ºä¸åŒèŠ‚ç‚¹è®¾è®¡ä¸“å±å›¾æ ‡ä»¥æå‡ç”¨æˆ·ä½“éªŒ
5. **æ€§èƒ½ä¼˜åŒ–**ï¼šä¼˜åŒ–å¤§æ–‡ä»¶ä¸Šä¼ å’Œæ‰¹é‡æ“ä½œçš„æ€§èƒ½
6. **éªŒè¯å¢å¼º**ï¼šæ·»åŠ å‚æ•°éªŒè¯å’Œæ•°æ®æ ¼å¼æ£€æŸ¥

## ğŸ¯ é¡¹ç›®çŠ¶æ€

**çŠ¶æ€**: âœ… **å·²å®Œæˆå…¨éƒ¨ API åŠŸèƒ½å¼€å‘ï¼Œè¦†ç›–ç‡ 100%ï¼Œå‡†å¤‡æŠ•å…¥ç”Ÿäº§**

æ‰€æœ‰ 9 ä¸ª API åˆ†ç»„çš„æ ¸å¿ƒåŠŸèƒ½å·²å…¨éƒ¨å®ç°å¹¶éªŒè¯é€šè¿‡ï¼ŒåŒ…æ‹¬è®¤è¯ã€ç”¨æˆ·ç®¡ç†ã€ç®¡ç†å‘˜ç®¡ç†ã€ç´ æåº“ç®¡ç†ã€æ’ä»¶ç®¡ç†ã€æ–‡ä»¶ç®¡ç†ã€æ•°æ®åº“ç®¡ç†ã€è®¾å¤‡ç®¡ç†å’Œç³»ç»ŸçŠ¶æ€ç­‰ï¼Œèƒ½å¤Ÿæ»¡è¶³ Mira App Server çš„æ‰€æœ‰ä¸»è¦æ“ä½œéœ€æ±‚ã€‚
