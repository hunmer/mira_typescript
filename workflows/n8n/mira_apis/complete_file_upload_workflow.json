{
    "name": "Mira 文件上传工作流（完整版）",
    "nodes": [
        {
            "parameters": {
                "formTitle": "上传文件到 Mira 素材库",
                "formDescription": "请选择要上传的文件并填写相关信息",
                "formFields": {
                    "values": [
                        {
                            "fieldLabel": "文件",
                            "fieldType": "file",
                            "requiredField": true,
                            "multipleFiles": false
                        },
                        {
                            "fieldLabel": "素材库ID",
                            "fieldType": "text",
                            "requiredField": true,
                            "placeholder": "请输入素材库ID"
                        },
                        {
                            "fieldLabel": "文件夹",
                            "fieldType": "text",
                            "requiredField": false,
                            "placeholder": "文件夹名称（可选）"
                        },
                        {
                            "fieldLabel": "标签",
                            "fieldType": "text",
                            "requiredField": false,
                            "placeholder": "用逗号分隔多个标签"
                        }
                    ]
                },
                "responseMode": "onReceived"
            },
            "id": "form-trigger",
            "name": "文件上传表单",
            "type": "n8n-nodes-base.formTrigger",
            "typeVersion": 2.3,
            "position": [
                200,
                300
            ]
        },
        {
            "parameters": {
                "method": "POST",
                "url": "http://localhost:8081/api/files/upload",
                "authentication": "none",
                "sendHeaders": true,
                "headerParameters": {
                    "parameters": [
                        {
                            "name": "Authorization",
                            "value": "Bearer mira-token-1-1755904810547-9c70962a10fe6f67a467bbdfe8859d1c57e8c38a9d7ec66f90dc68161694a7cd"
                        }
                    ]
                },
                "sendBody": true,
                "contentType": "multipart-form-data",
                "bodyParameters": {
                    "parameters": [
                        {
                            "name": "libraryId",
                            "value": "={{ $json['素材库ID'] }}"
                        },
                        {
                            "name": "payload",
                            "value": "={{ JSON.stringify({ data: { tags: $json['标签'] ? $json['标签'].split(',').map(tag => tag.trim()).filter(tag => tag) : [], folder_id: $json['文件夹'] || null } }) }}"
                        },
                        {
                            "name": "files",
                            "parameterType": "formBinaryData",
                            "inputDataFieldName": "文件"
                        }
                    ]
                },
                "options": {
                    "response": {
                        "response": {
                            "responseFormat": "json"
                        }
                    }
                }
            },
            "id": "http-upload",
            "name": "上传到 Mira API",
            "type": "n8n-nodes-base.httpRequest",
            "typeVersion": 4.2,
            "position": [
                600,
                300
            ],
            "onError": "continueRegularOutput",
            "retryOnFail": true,
            "maxTries": 3,
            "waitBetweenTries": 1000
        }
    ],
    "connections": {
        "文件上传表单": {
            "main": [
                [
                    {
                        "node": "上传到 Mira API",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        }
    },
    "pinData": {},
    "settings": {
        "executionOrder": "v1"
    },
    "staticData": {},
    "tags": [],
    "triggerCount": 0,
    "meta": {
        "instanceId": "abe2a09b2ef5660ef8a2dbbe628e3a16ce0dd70fa8c8e37437fa2afceac1eacc"
    }
}